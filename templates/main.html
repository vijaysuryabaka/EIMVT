<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css" rel="stylesheet"> <!-- Font Awesome CSS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">
    <title>Document</title>
    <style>
        body {
            font-family: 'Raleway', sans-serif;
            background-color: #FBF6F1;
            color: #00694e;
        }
        nav{
            background-color: #FBF6F1;
            height: 60px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.6); 
        }
        h4 {
            font-size: 30px;
            color: #00694e;
        }
        img {
            max-width: 7%;
            max-height: 7%;
        }
        .prof{
            width: 35px !important; 
            
        }
        select{
            margin-left: 10px;
            width: 250px;
            height: 43px;
            border-radius: 36px;
            padding: 10px;
            color: #00694E;
            border: 1px solid #00694E;
            background-color: #FBF6F1
        }
        #start, #stop{
            background-color: #8CE6CD;
            color: #00694E;
            z-index: 1;
            border-radius: 36px;
            border: none;
            font-size: 18px;
            width: 181px;
            height: 50px;
            cursor: pointer;
        }
        #arrow{
            background-color:unset;
            border: none;

        }
        #arrow img{
            width: 300px !important;
        }
        /* .label-div {
            display: flex;
            align-items: center;
        } */
        .label-div p {
            display: inline-block;
            color: #00694E;
            margin-top: 30px; 
        }
        .audio-div {
            width: 50%;
            margin: auto;
            padding: 10px;
            border-radius: 10px;
        }
        button:disabled {
            opacity: 0.6; /* Reduce opacity to indicate disabled state */
            cursor: not-allowed; /* Change cursor to indicate disabled state */
            color: black;
            cursor: not-allowed;
        }

        #start:hover{
            background-color: green;
            color: cornsilk;
        }

        #stop:hover{
            background-color: red;
            color: cornsilk;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container-fluid">
            <img src="static/nav logo.png" alt="logo">
            <img class="prof" src="static/gg_profile.png" alt="prof">
        </div>
    </nav>

    <main style="background-color: #FBF6F1;">
        <div class="container-fluid">
            <div class="row text-center" style="margin: 40px 0px 30px 0;">
                <h4>Emotional Intelligence Multi-Lingual Voice Translator</h4>
            </div>

            <div class="row d-flex align-items-center justify-content-between" style="margin: 0px 0px 30px 0;">
                <div class="col d-flex align-items-end">
                    <div class="label-div">
                        <label for="from">Source Language : </label>
                        <select name="from" id="from">
                            <option value="" selected>Choose a Language</option>
                            <option value="tam">Tamil</option>
                            <option value="eng">English</option>
                            <option value="fre">French</option>
                            <option value="jap">Japanese</option>
                            <option value="hin">Hindi</option>
                        </select>
                    </div>
                </div>
                <div class="col d-flex align-items-center justify-content-center">
                    <button id="arrow"><img src="static/arrow.png" alt="arrow"></button>
                </div>
                <div class="col">
                    <div class="label-div">
                        <label for="to">Target Language : </label>
                        <select name="to" id="to">
                            <option value="" selected>Choose a Language</option>
                            <option value="tam">Tamil</option>
                            <option value="eng">English</option>
                            <option value="fre">French</option>
                            <option value="jap">Japanese</option>
                            <option value="hin">Hindi</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="row d-flex">
                <div class="col d-flex align-items-center justify-content-center" style="margin: 0px 0px 30px 0;">
                    <button id="start" style="margin-right: 10px;">Start Recording</button>
                    <button id="stop" style="margin-left: 10px;" disabled>Stop Recording</button>
                </div>
            </div>

            <div class="row d-flex flex-column text-center" style="margin: 0px 0px 30px 0;">
                <div class="tscribe">
                    <div class="label-div">
                        <label for="tscribe_text">Transcribed Text : </label>
                        <p id="tscribe_text"></p>
                    </div>
                </div>

                <div class="tslate">
                    <div class="label-div">
                        <label for="tslate_text">Translated Text : </label>
                        <p id="tslate_text"></p>
                    </div>
                </div>

                <div class="emotion">
                    <div class="label-div">
                        <label for="emo">Emotion : </label>
                        <p id="emo"></p>
                    </div>
                </div>
            </div>

            <div class="row d-flex justify-content-center">
                <div class="col audio-div d-flex align-items-center justify-content-center">
                    <audio id="audioPlayer" controls autoplay >
                        <source id="audioSource" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                </div>
            </div>
        </div>
    </main>

    <script>
        $(document).ready(function() {
            $('#arrow').click(function() {
            var fromValue = $('#from').val();
            var toValue = $('#to').val();
            
            $('#from').val(toValue);
            $('#to').val(fromValue);
        });

            $('#start').click(function() {
                $.post('/start', function(data) {
                    if (data.success) {
                        $('#start').prop('disabled', true);
                        $('#stop').prop('disabled', false);
                    }
                });
            });

            $('#stop').click(function() {
                var fromlang = $('#from').val();
                var tolang = $('#to').val();
                $.post('/stop', {from: fromlang, to: tolang}, function(data) {
                    if (data.success) {
                        $('#start').prop('disabled', false);
                        $('#stop').prop('disabled', true);

                        // Update the UI with response data
                        $('#tscribe_text').text(data.tscribed_text);
                        $('#tslate_text').text(data.tslated_text);
                        $('#emo').text(data.emotion);
                        console.log("Audio file path:", data.audio);


                        // Update audio source
                        $('#audioSource').attr('src', data.audio);



                        // Load and play the audio
                        var audioPlayer = $('#audioPlayer')[0];
                        audioPlayer.load();
                        audioPlayer.play();     
                }
                });
            });
        });
    </script>
</body>
</html>
